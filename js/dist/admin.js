module.exports=function(t){var n={};function r(a){if(n[a])return n[a].exports;var e=n[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,r),e.l=!0,e.exports}return r.m=t,r.c=n,r.d=function(t,n,a){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var e in t)r.d(a,e,function(n){return t[n]}.bind(null,e));return a},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=33)}([function(t,n,r){"use strict";function a(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}r.d(n,"a",(function(){return a}))},function(t,n){t.exports=flarum.core.compat.Model},function(t,n){t.exports=flarum.core.compat["common/utils/Stream"]},function(t,n){t.exports=flarum.core.compat.Component},function(t,n){t.exports=flarum.core.compat["common/components/Button"]},function(t,n,r){"use strict";function a(){return(a=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t}).apply(this,arguments)}r.d(n,"a",(function(){return a}))},function(t,n){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,n,r){"use strict";function a(t){var n=t.filter((function(t){return t.actions()})).reduce((function(t,n){var r=n.actions().filter((function(t){return"add_to_group"===t.type||"remove_from_group"===t.type})).map((function(t){return t.settings.group_id}));return t.push.apply(t,r),t}),[]);return Array.from(new Set(n).values()).map((function(t){return app.store.getById("groups",t)})).filter((function(t){return t}))}r.d(n,"a",(function(){return a}))},function(t,n){t.exports=flarum.core.compat["common/helpers/icon"]},function(t,n){t.exports=flarum.core.compat["common/components/Tooltip"]},function(t,n){t.exports=flarum.core.compat["common/utils/classList"]},function(t,n,r){"use strict";r.d(n,"a",(function(){return u}));var a=r(0),e=r(12),i=r.n(e),o=r(18),s=r.n(o),c=r(7),u=function(t){function n(){return t.apply(this,arguments)||this}return Object(a.a)(n,t),n.prototype.view=function(){var t=Object(c.a)(this.attrs.criteria),n=this.attrs.user;return m("div",{className:"ManagedGroups Form-group"},m("hr",null),m("h4",null,app.translator.trans("askvortsov-auto-moderator.lib.managed_groups.header")),m("ul",null,t.map((function(t){return m("label",{className:"checkbox"},n&&m("input",{type:"checkbox",checked:n.groups().includes(t),disabled:!0}),app.translator.trans("askvortsov-auto-moderator.lib.managed_groups.group_item",{badge:s.a.component({group:t,label:""}),groupName:t.nameSingular()}))}))),m("p",null,app.translator.trans("askvortsov-auto-moderator.lib.managed_groups.groups_not_editable")))},n}(i.a)},function(t,n){t.exports=flarum.core.compat["common/Component"]},function(t,n){t.exports=flarum.core.compat["common/extend"]},function(t,n){t.exports=flarum.core.compat["common/components/EditUserModal"]},function(t,n){t.exports=flarum.core.compat["common/components/Alert"]},function(t,n,r){"use strict";r.d(n,"a",(function(){return d}));var a=r(13),e=r(14),i=r.n(e),o=r(6),s=r.n(o),c=r(17),u=r.n(c),l=r(7),p=r(11);function d(){Object(a.extend)(i.a.prototype,"oninit",(function(){var t=this;this.loading=!0,app.store.find("criteria").then((function(n){Object(l.a)(n).forEach((function(n){return delete t.groups[n.id()]})),t.loading=!1,m.redraw()}))})),Object(a.override)(i.a.prototype,"fields",(function(t){if(this.loading){var n=new u.a;return n.add("loading",m(s.a,null)),n}var r=t();return r.add("Criteria",m(p.a,{criteria:app.store.all("criteria"),user:this.attrs.user}),10),r}))}},function(t,n){t.exports=flarum.core.compat["common/utils/ItemList"]},function(t,n){t.exports=flarum.core.compat["common/components/GroupBadge"]},function(t,n){t.exports=flarum.core.compat["models/User"]},function(t,n,r){"use strict";r.d(n,"a",(function(){return u}));var a=r(1),e=r.n(a),i=r(19),o=r.n(i),s=r(5),c=r(0),m=function(t){function n(){return t.apply(this,arguments)||this}return Object(c.a)(n,t),n}(e.a);function u(){app.store.models.criteria=m,o.a.prototype.criteria=e.a.hasMany("criteria")}Object(s.a)(m.prototype,{name:e.a.attribute("name"),icon:e.a.attribute("icon"),description:e.a.attribute("description"),actions:e.a.attribute("actions"),metrics:e.a.attribute("metrics"),requirements:e.a.attribute("requirements"),isValid:e.a.attribute("isValid"),invalidActionSettings:e.a.attribute("invalidActionSettings"),invalidRequirementSettings:e.a.attribute("invalidRequirementSettings")})},function(t,n){t.exports=flarum.core.compat["common/components/Select"]},function(t,n){t.exports=flarum.core.compat["components/Button"]},function(t,n){t.exports=flarum.core.compat["common/components/Switch"]},function(t,n){t.exports=flarum.core.compat["utils/Stream"]},function(t,n){t.exports=flarum.core.compat["models/Group"]},function(t,n){t.exports=flarum.core.compat["admin/components/ExtensionPage"]},function(t,n){t.exports=flarum.core.compat["common/components/Link"]},function(t,n){t.exports=flarum.core.compat["common/utils/stringToColor"]},function(t,n){t.exports=flarum.core.compat["admin/components/AdminPage"]},function(t,n){t.exports=flarum.core.compat["common/components/LinkButton"]},function(t,n){t.exports=flarum.core.compat["components/Dropdown"]},function(t,n){t.exports=flarum.core.compat["helpers/icon"]},function(t,n,r){"use strict";r.r(n);var a=r(16),e=r(20),i=r(0),o=r(26),s=r.n(o),c=r(27),u=r.n(c),l=r(6),p=r.n(l),d=r(9),f=r.n(d),v=r(8),h=r.n(v),g=r(10),b=r.n(g),y=r(28),_=r.n(y),x=r(11),N=r(3),k=r.n(N),O=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){return m("div",{className:"AutoModeratorInstructions"},m("h4",null,app.translator.trans("askvortsov-auto-moderator.admin.automoderator_instructions.header")),m("ul",null,app.translator.trans("askvortsov-auto-moderator.admin.automoderator_instructions.text")))},n}(k.a);function w(t){var n=t?t.name():app.translator.trans("askvortsov-auto-moderator.admin.automoderator_page.create_criterion_button"),r=t?t.icon()||"fas fa-bolt":"fas fa-plus",a=t?{"background-color":"#"+_()(t.name())}:"";return m(u.a,{className:"ExtensionListItem",href:app.route.criterion(t)},m("span",{className:"ExtensionListItem-icon ExtensionIcon",style:a},h()(r)),m("span",{className:b()({"ExtensionListItem-title":!0,"ExtensionListItem--invalid":t&&!t.isValid()})},t&&!t.isValid()&&m(f.a,{text:app.translator.trans("askvortsov-auto-moderator.admin.automoderator_page.criterion_invalid")},h()("fas fa-exclamation-triangle")),n))}var D=function(t){function n(){return t.apply(this,arguments)||this}Object(i.a)(n,t);var r=n.prototype;return r.oninit=function(n){var r=this;t.prototype.oninit.call(this,n),this.loading=!0,app.store.find("criteria").then((function(){r.loading=!1,m.redraw()}))},r.content=function(){return this.loading?m("div",{className:"Criteria"},m("div",{className:"container"},m(p.a,null))):m("div",{className:"Criteria"},m("div",{className:"container"},m("div",{className:"ExtensionsWidget-list Criteria-list"},m("p",{className:"Criteria-list-heading"},app.translator.trans("askvortsov-auto-moderator.admin.automoderator_page.list_heading")),m("div",{className:"ExtensionList"},[].concat(app.store.all("criteria").map(w),[w()]))),m(x.a,{criteria:app.store.all("criteria")}),m("hr",null),m(O,null)))},n}(s.a),L=r(5),j=r(29),E=r.n(j),q=r(4),S=r.n(q),B=r(30),G=r.n(B),F=r(21),C=r.n(F),I=r(2),M=r.n(I),T=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t=this.attrs.item,n=this.attrs.selected;return m("li",null,m("div",{className:"DriverListItem-info"},m("span",{className:"DriverListItem-name DriverListItem-undefined"},app.translator.trans("askvortsov-auto-moderator.admin.undefined_driver_item.text",{driverName:t.type})),S.a.component({className:"Button Button--link",icon:"fas fa-trash-alt",onclick:function(){return n(n().filter((function(n){return n!==t})))}})),m("hr",null))},n}(k.a),A=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t,n=this.attrs.driverType,r=this.attrs.type,a=this.attrs.settings,e=this.attrs.availableSettings,i=app.autoModeratorForms[n];return t=r in i?i[r].component({settings:a,availableSettings:e}):Object.keys(e).map((function(t){return m("div",{className:"Form-group"},m("input",{className:"FormControl",value:a()[t],onchange:function(n){var r=Object(L.a)({},a());r[t]=n.target.value,a(r)},placeholder:app.translator.trans(e[t])}))})),m("div",{className:"DriverListItem-form"},t)},n}(k.a),P=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t=this.attrs.action,n=this.attrs.actionDef,r=this.attrs.selected;return n?m("li",null,m("div",{className:b()({"DriverListItem-info":!0,"DriverListItem--missingExt":n.missingExt})},n.missingExt&&m(f.a,{text:app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.driver_missing_ext")},h()("fas fa-exclamation-triangle")),m("span",{className:"DriverListItem-name"},app.translator.trans(n.translationKey)),S.a.component({className:"Button Button--link",icon:"fas fa-trash-alt",onclick:function(){return r(r().filter((function(n){return n!==t})))}}),m(A,{driverType:"action",type:t.type,settings:t.settings,availableSettings:n.availableSettings})),m("hr",null)):m(T,{item:t,selected:r})},n}(k.a),R=r(22),K=r.n(R),W=r(24),V=r.n(W),U=function(t){function n(){return t.apply(this,arguments)||this}Object(i.a)(n,t);var r=n.prototype;return r.oninit=function(n){t.prototype.oninit.call(this,n),this.state=-1,-1!==this.attrs.min()&&(this.state+=1),-1!==this.attrs.max()&&(this.state+=2),this.min=V()(this.attrs.min()),this.max=V()(this.attrs.max())},r.view=function(){return m("div",{className:"Form-group MinMaxSelector"},m("label",null,this.attrs.label),m("div",{className:"MinMaxSelector--inputs"},this.controls()))},r.controls=function(){var t=this,r=function(){return m("input",{className:"FormControl",type:"number",min:"0",max:t.state===n.State.BETWEEN?-1!==t.attrs.max()?t.attrs.max():t.max():1/0,placeholder:"min",bidi:t.attrs.min})},a=function(){return m("input",{className:"FormControl",type:"number",min:t.state===Math.max(0,n.State.BETWEEN?-1!==t.attrs.min()?t.attrs.min():t.min():0),placeholder:"max",bidi:t.attrs.max})},e=function(){return m("input",{className:"FormControl MinMaxSelector--placeholder",disabled:!0,placeholder:"X"})},i=function(n){return m(K.a,{className:"Button",onclick:t.cycle.bind(t),icon:n})};switch(this.state){case n.State.LTE:return[e(),i("fas fa-less-than-equal"),a()];case n.State.GTE:return[e(),i("fas fa-greater-than-equal"),r()];case n.State.BETWEEN:return[r(),i("fas fa-less-than-equal"),e(),i("fas fa-less-than-equal"),a()]}},r.cycle=function(){switch(this.state++,this.state%=3,-1!==this.attrs.min()&&this.min(this.attrs.min()),-1!==this.attrs.max()&&this.max(this.attrs.max()),this.state){case n.State.GTE:this.attrs.min(this.min()),this.attrs.max(-1);break;case n.State.LTE:this.attrs.min(-1),this.attrs.max(this.max());break;case n.State.BETWEEN:this.attrs.min(this.min()),this.attrs.max(this.max())}},n}(k.a);U.State={GTE:0,LTE:1,BETWEEN:2};var z,X,H,J=U,Q=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t=this.attrs.metric,n=this.attrs.metricDef,r=this.attrs.selected;return n?m("li",null,m("div",{className:b()({"DriverListItem-info":!0,"DriverListItem--missingExt":n.missingExt})},n.missingExt&&m(f.a,{text:app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.driver_missing_ext")},h()("fas fa-exclamation-triangle")),m("span",{className:"DriverListItem-name"},app.translator.trans(n.translationKey)),S.a.component({className:"Button Button--link",icon:"fas fa-trash-alt",onclick:function(){return r(r().filter((function(n){return n!==t})))}})),m(J,{min:t.min,max:t.max}),m("hr",null)):m(T,{item:t,selected:r})},n}(k.a),Y=r(23),Z=r.n(Y),$=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t=this.attrs.requirement,n=this.attrs.requirementDef,r=this.attrs.selected;return n?m("li",null,m("div",{className:b()({"DriverListItem-info":!0,"DriverListItem--missingExt":n.missingExt})},n.missingExt&&m(f.a,{text:app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.driver_missing_ext")},h()("fas fa-exclamation-triangle")),m("span",{className:"DriverListItem-name"},app.translator.trans(n.translationKey)),S.a.component({className:"Button Button--link",icon:"fas fa-trash-alt",onclick:function(){return r(r().filter((function(n){return n!==t})))}})),m(Z.a,{state:t.negated(),onchange:t.negated},app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.negated")),m(A,{driverType:"requirement",type:t.type,settings:t.settings,availableSettings:n.availableSettings}),m("hr",null)):m(T,{item:t,selected:r})},n}(k.a),tt=r(15),nt=r.n(tt),rt=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t=this.attrs.criterion;if(t){var n=[];t.isValid()?n.push(m(nt.a,{type:"success",dismissible:!1},app.translator.trans("askvortsov-auto-moderator.admin.criterion_status.valid"))):n.push(m(nt.a,{type:"error",dismissible:!1},app.translator.trans("askvortsov-auto-moderator.admin.criterion_status.invalid")));var r=t.invalidActionSettings();r&&Object.keys(r).length&&n.push(m(nt.a,{type:"error",dismissible:!1},app.translator.trans("askvortsov-auto-moderator.admin.criterion_status.action_validation_errors"),m("div",null,m("ol",null,Object.keys(r).map((function(t){return m("li",null,m("strong",null,t,":")," ",r[t].join(""))}))))));var a=t.invalidRequirementSettings();return a&&Object.keys(a).length&&n.push(m(nt.a,{type:"error",dismissible:!1},app.translator.trans("askvortsov-auto-moderator.admin.criterion_status.requirement_validation_errors"),m("div",null,m("ol",null,Object.keys(a).map((function(t){return m("li",null,m("strong",null,t,":")," ",a[t].join(""))})))))),0===t.metrics().length&&0===t.requirements().length&&n.push(m(nt.a,{type:"danger",dismissible:!1},app.translator.trans("askvortsov-auto-moderator.admin.criterion_status.no_metrics_or_reqs"))),0===t.actions().length&&n.push(m(nt.a,{type:"danger",dismissible:!1},app.translator.trans("askvortsov-auto-moderator.admin.criterion_status.no_actions"))),m("div",{className:"StatusCheck Form-group"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_status.heading")),n)}},n}(k.a),at=function(t){function n(){return t.apply(this,arguments)||this}Object(i.a)(n,t);var r=n.prototype;return r.oninit=function(n){var r=this;t.prototype.oninit.call(this,n),this.id=m.route.param("id"),this.name=M()(""),this.icon=M()("fas fa-bolt"),this.description=M()(""),this.actionsOnGain=M()([]),this.actionsOnLoss=M()([]),this.metrics=M()([]),this.requirements=M()([]),this.newActionOnGain=M()(""),this.newActionOnLoss=M()(""),this.newMetric=M()(""),this.newRequirement=M()(""),this.loadingDrivers=!0,app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/automod_drivers"}).then((function(t){z=t.data.attributes.action,X=t.data.attributes.metric,H=t.data.attributes.requirement,r.loadingDrivers=!1,m.redraw()})),"new"!==this.id&&(this.loadingCriterion=!0,app.store.find("criteria",this.id).then((function(t){r.loadCriterion(t),r.loadingCriterion=!1,m.redraw()})))},r.loadCriterion=function(t){this.criterion=t,this.name(t.name()),this.icon(t.icon()||"fas fa-bolt"),this.description(t.description()),this.metrics(t.metrics().map((function(t){return{type:t.type,min:M()(t.min),max:M()(t.max)}}))),this.actionsOnGain(t.actions().filter((function(t){return t.gain})).map((function(t){return{type:t.type,settings:M()(t.settings)}}))),this.actionsOnLoss(t.actions().filter((function(t){return!t.gain})).map((function(t){return{type:t.type,settings:M()(t.settings)}}))),this.requirements(t.requirements().map((function(t){return{type:t.type,negated:M()(t.negated),settings:M()(t.settings)}})))},r.headerInfo=function(){var t,n="";return this.loadingCriterion?(n=app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.loading"),t=app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.loading")):t=this.criterion?this.criterion.name():app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.new_criterion"),{className:"CriterionPage",icon:this.icon(),title:t,description:n}},r.content=function(){return this.loadingCriterion||this.loadingDrivers?m("div",{className:"Criteria"},m("div",{className:"container"},m(p.a,null))):m("div",{className:"Criteria"},m("div",{className:"container"},m("form",{onsubmit:this.onsubmit.bind(this)},m("div",{className:"Form-group"},m(G.a,{className:"Button",icon:"fas fa-chevron-left",href:app.route("extension",{id:"askvortsov-auto-moderator"})},app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.back"))),m(rt,{criterion:this.criterion}),m("div",{className:"Form-group"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.name_label")),m("input",{className:"FormControl",bidi:this.name,required:!0})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.icon_label")),m("input",{className:"FormControl",bidi:this.icon,required:!0})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.description_label")),m("input",{className:"FormControl",bidi:this.description})),this.metricsAndRequirementsForm(),this.actionsForm(),m("div",{className:"Form-group"},m(S.a,{type:"submit",className:"Button Button--primary",loading:this.saving,disabled:this.saving},app.translator.trans("core.admin.settings.submit_button"))),this.criterion&&m(S.a,{type:"button",onclick:this.delete.bind(this),className:"Button Button--danger",loading:this.deleting,disabled:this.saving},app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.delete_button"))),m("hr",null),m(O,null)))},r.metricsAndRequirementsForm=function(){var t=this;return m("div",{className:"Form-group"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.metrics_and_requirements_label")),m("div",{className:"helpText"},app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.metrics_and_requirements_help")),m("div",{className:"SettingsGroups"},m("div",{className:"DriverGroup"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.metrics_heading")),m("ul",{className:"DriverList DriverList--primary"},this.metrics().map((function(n){return m(Q,{metric:n,metricDef:X[n.type],selected:t.metrics})}))),m("span",{class:"DriverGroup-controls"},C.a.component({options:Object.keys(X).reduce((function(t,n){return t[n]=app.translator.trans(X[n].translationKey),t}),{}),value:this.newMetric(),onchange:this.newMetric}),S.a.component({className:"Button DriverList-button",icon:"fas fa-plus",disabled:!this.newMetric(),onclick:function(){t.metrics([].concat(t.metrics(),[{type:t.newMetric(),min:M()(),max:M()()}]))}}))),m("div",{className:"DriverGroup DriverGroup--secondary"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.requirements_heading")),m("ul",{className:"DriverList DriverList--primary"},this.requirements().map((function(n){return m($,{requirement:n,requirementDef:H[n.type],selected:t.requirements})}))),m("span",{class:"DriverGroup-controls"},C.a.component({options:Object.keys(H).reduce((function(t,n){return t[n]=app.translator.trans(H[n].translationKey),t}),{}),value:this.newRequirement(),onchange:this.newRequirement}),S.a.component({className:"Button DriverList-button",icon:"fas fa-plus",disabled:!this.newRequirement(),onclick:function(){t.requirements([].concat(t.requirements(),[{type:t.newRequirement(),negated:M()(!1),settings:M()({})}]))}})))))},r.actionsForm=function(){var t=this;return m("div",{className:"Form-group"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.actions_label")),m("div",{className:"helpText"},app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.actions_help")),m("div",{className:"SettingsGroups"},m("div",{className:"DriverGroup"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.actions_on_gain_heading")),m("ul",{className:"DriverList DriverList--primary"},this.actionsOnGain().map((function(n){return m(P,{action:n,actionDef:z[n.type],selected:t.actionsOnGain})}))),m("span",{class:"DriverGroup-controls"},C.a.component({options:Object.keys(z).reduce((function(t,n){return t[n]=app.translator.trans(z[n].translationKey),t}),{}),value:this.newActionOnGain(),onchange:this.newActionOnGain}),S.a.component({className:"Button DriverList-button",icon:"fas fa-plus",disabled:!this.newActionOnGain(),onclick:function(){t.actionsOnGain([].concat(t.actionsOnGain(),[{type:t.newActionOnGain(),settings:M()({})}]))}}))),m("div",{className:"DriverGroup DriverGroup--secondary"},m("label",null,app.translator.trans("askvortsov-auto-moderator.admin.criterion_page.actions_on_loss_heading")),m("ul",{className:"DriverList"},this.actionsOnLoss().map((function(n){return m(P,{action:n,actionDef:z[n.type],selected:t.actionsOnLoss})}))),m("span",{class:"DriverGroup-controls"},C.a.component({options:Object.keys(z).reduce((function(t,n){return t[n]=app.translator.trans(z[n].translationKey),t}),{}),value:this.newActionOnLoss(),onchange:this.newActionOnLoss}),S.a.component({className:"Button DriverList-button",icon:"fas fa-plus",disabled:!this.newActionOnLoss(),onclick:function(){t.actionsOnLoss([].concat(t.actionsOnLoss(),[{type:t.newActionOnLoss(),settings:M()({})}]))}})))))},r.data=function(){return{name:this.name(),icon:this.icon(),description:this.description(),actions:[].concat(this.actionsOnGain().map((function(t){return Object(L.a)({},t,{gain:!0,settings:t.settings()})})),this.actionsOnLoss().map((function(t){return Object(L.a)({},t,{gain:!1,settings:t.settings()})}))),metrics:this.metrics().map((function(t){return{type:t.type,min:t.min(),max:t.max()}})),requirements:this.requirements().map((function(t){return{type:t.type,negated:t.negated(),settings:t.settings()}}))}},r.delete=function(t){t.preventDefault(),this.deleting=!0,m.redraw(),this.criterion.delete().then((function(){m.route.set(app.route("extension",{id:"askvortsov-auto-moderator"}))}))},r.onsubmit=function(t){var n=this;t.preventDefault(),this.saving=!0,m.redraw();var r=this.criterion||app.store.createRecord("criteria");r.save(this.data()).then((function(t){"new"===n.id?m.route.set(app.route.criterion(t)):(n.loadCriterion(r),n.saving=!1,m.redraw())}))},n}(E.a),et=r(31),it=r.n(et),ot=r(32),st=r.n(ot),ct=r(25),mt=r.n(ct),ut=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t=this,n=app.store.getById("groups",this.attrs.value),r=n?[st()(n.icon()),"\t",n.namePlural()]:app.translator.trans("askvortsov-auto-moderator.admin.group_selector.placeholder");return m("div",{className:"Form-group"},m("label",null,this.attrs.label),this.attrs.disabled?m("div",{className:"Button Button--danger"},r):m(it.a,{label:r,disabled:this.attrs.disabled,buttonClassName:"Button Button--danger"},app.store.all("groups").filter((function(t){return![mt.a.MEMBER_ID,mt.a.GUEST_ID].includes(t.id())})).map((function(r){return K.a.component({active:n&&n.id()===r.id(),disabled:n&&n.id()===r.id(),icon:r.icon(),onclick:function(){t.attrs.onchange(r.id())}},r.namePlural())}))))},n}(k.a),lt=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t=this.attrs.settings;return m(ut,{value:t().group_id,onchange:function(n){return t({group_id:n})}})},n}(k.a),pt=r(12),dt=function(t){function n(){return t.apply(this,arguments)||this}return Object(i.a)(n,t),n.prototype.view=function(){var t=this.attrs.settings;return m("div",{className:"Form-group"},m("div",{className:"Form-group"},m(Z.a,{state:t().indefinitely,onchange:function(n){return t(Object(L.a)({},t(),{indefinitely:n}))}},app.translator.trans("askvortsov-auto-moderator.admin.suspend_selector.indefinitely"))),!t().indefinitely&&m("div",{className:"Form-group"},m("input",{className:"FormControl",type:"number",min:"0",value:t().days,onchange:function(n){return t(Object(L.a)({},t(),{days:n.target.value}))},placeholder:app.translator.trans("askvortsov-auto-moderator.admin.suspend_selector.days")})))},n}(r.n(pt).a);app.initializers.add("askvortsov/flarum-auto-moderator",(function(){app.routes.criterion={path:"/askvortsov-auto-moderator/criterion/:id",component:at},app.autoModeratorForms={action:{add_to_group:lt,remove_from_group:lt,suspend:dt},requirement:{in_group:lt}},app.extensionData.for("askvortsov-auto-moderator").registerPage(D),app.route.criterion=function(t){return app.route("criterion",{id:(null==t?void 0:t.id())||"new"})},Object(a.a)(),Object(e.a)()}))}]);
//# sourceMappingURL=admin.js.map