(()=>{var t={n:r=>{var o=r&&r.__esModule?()=>r.default:()=>r;return t.d(o,{a:o}),o},d:(r,o)=>{for(var e in o)t.o(o,e)&&!t.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:o[e]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};(()=>{"use strict";t.r(r);const o=flarum.core.compat["common/app"];t.n(o)().initializers.add("askvortsov/flarum-automod",(function(){console.log("[askvortsov/flarum-automod] Hello, forum and admin!")}));const e=flarum.core.compat["common/extend"],n=flarum.core.compat["common/components/EditUserModal"];var a=t.n(n);const i=flarum.core.compat["common/components/LoadingIndicator"];var u=t.n(i);const s=flarum.core.compat["common/utils/ItemList"];var c=t.n(s);function p(t){var r=t.filter((function(t){return t.actions()})).reduce((function(t,r){var o=r.actions().filter((function(t){return"add_to_group"===t.type||"remove_from_group"===t.type})).map((function(t){return t.settings.group_id}));return t.push.apply(t,o),t}),[]);return Array.from(new Set(r).values()).map((function(t){return app.store.getById("groups",t)})).filter((function(t){return t}))}function l(t,r){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},l(t,r)}function d(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,l(t,r)}const f=flarum.core.compat["common/Component"];var g=t.n(f);const v=flarum.core.compat["common/components/GroupBadge"];var b=t.n(v),y=function(t){function r(){return t.apply(this,arguments)||this}return d(r,t),r.prototype.view=function(){var t=p(this.attrs.criteria),r=this.attrs.user;return m("div",{className:"ManagedGroups Form-group"},m("hr",null),m("h4",null,app.translator.trans("askvortsov-automod.lib.managed_groups.header")),m("ul",null,t.map((function(t){return m("label",{className:"checkbox"},r&&m("input",{type:"checkbox",checked:r.groups().includes(t),disabled:!0}),app.translator.trans("askvortsov-automod.lib.managed_groups.group_item",{badge:b().component({group:t,label:""}),groupName:t.nameSingular()}))}))),m("p",null,app.translator.trans("askvortsov-automod.lib.managed_groups.groups_not_editable")))},r}(g());const h=flarum.core.compat.Model;var _=t.n(h);const O=flarum.core.compat["models/User"];var S=t.n(O),k=function(t){function r(){return t.apply(this,arguments)||this}return d(r,t),r}(_());Object.assign(k.prototype,{name:_().attribute("name"),icon:_().attribute("icon"),description:_().attribute("description"),actions:_().attribute("actions"),metrics:_().attribute("metrics"),requirements:_().attribute("requirements"),isValid:_().attribute("isValid"),invalidActionSettings:_().attribute("invalidActionSettings"),invalidRequirementSettings:_().attribute("invalidRequirementSettings")}),app.initializers.add("askvortsov/flarum-automod",(function(){app.store.models.criteria=k,S().prototype.criteria=_().hasMany("criteria"),(0,e.extend)(a().prototype,"oninit",(function(){var t=this;this.loading=!0,app.store.find("criteria").then((function(r){p(r).forEach((function(r){return delete t.groups[r.id()]})),t.loading=!1,m.redraw()}))})),(0,e.override)(a().prototype,"fields",(function(t){if(this.loading){var r=new(c());return r.add("loading",m(u(),null)),r}var o=t();return o.add("Criteria",m(y,{criteria:app.store.all("criteria"),user:this.attrs.user}),10),o}))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map